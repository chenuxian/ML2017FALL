import csv
import sys
import codecs
import pandas

w = [0.17184333328115273, -0.075662683048184742, -0.057263256421132197, -0.029442536052000392, -0.063313145830153378, -0.017677078763220486, 0.0015569392277970588, 0.0036393234105388992, 0.052940513118783034, 0.13170682149670632, 0.0010948718314260598, 0.017101776135376449, 0.0058948189971506013, -0.0082906246348211608, -0.010957118276799013, -0.0049082237819408096, -0.0096964467923455425, -0.0197727949143842, 0.066961228820984015, 0.0034034317842897908, -0.0029961523671297209, -0.0070934613733575746, 0.027967295071079333, 0.018528551966978068, -0.026673882529463844, 0.0015790884650834793, 0.07893433787380516, 0.1218029836304042, 0.034776872365624795, -0.016276225138079411, 0.04333065089568934, -0.015970235755270557, 0.037821467628644981, 0.082518893896148804, 0.038744614414780741, 0.1558700400049598, 0.18248841913541808, 0.064703002485258218, -0.035467829528639465, 0.012417996976087472, -0.035634086814019521, -0.018664357045694618, 0.044828175149385051, -0.029918207589891121, 0.0017359328158384696, 6.0400892952583801e-05, 4.0711857896826661e-05, -3.2668624609153712e-05, 0.00011064010082881058, -4.5132161298025212e-06, -0.00059270997758789396, 0.00038401228444423838, 0.00022267884195241165, -0.0010379847518472538, -0.0001513012872328657, -0.0010567614445401714, 0.00041789707119526802, 0.001363311131375933, -0.0021019805903299254, -0.00010901823250076534, 0.0038648976196570201, -0.0072197392784132102, -0.00097507639896069181, 0.0095554982515822316]

index = 0
with open(sys.argv[2], 'w', encoding='utf-8') as f:
    spamwriter = csv.writer(f, delimiter=',')
    spamwriter.writerow(['id', 'value'])
    data = pandas.read_csv(sys.argv[1], header = -1).values.tolist()
    len_data = len(data)
    # start testing x_vector to get y
    for i in range(0, len_data, 18):
        x = []
        x += data[i][2:11]
        x += data[i+7][2:11]
        x += data[i+8][2:11]
        x += data[i+9][2:11]
        x += data[i+11][2:11]
        for j in range(i+8, i+10):
            for k in range(2, 11):
                x.append(float(data[j][k]) ** 2)

        # add bias
        inner_product = w[0]
        # do inner product
        for m in range(1, 64):
            inner_product += w[m] * float(x[m-1])
        spamwriter.writerow(['id_'+str(index), inner_product])
        index += 1
